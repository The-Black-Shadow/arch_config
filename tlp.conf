# ------------------------------------------------------------------------------
# /etc/tlp.conf - TLP user configuration (version 1.6.1)
# See full explanation: https://linrunner.de/tlp/settings
#
# Copyright (c) 2023 Thomas Koch <linrunner at gmx.net> and others.
# SPDX-License-Identifier: GPL-2.0-or-later
# ------------------------------------------------------------------------------
# tlp - Parameters for power saving

# Set to 0 to disable, 1 to enable TLP.
TLP_ENABLE=1

# Control how warnings about invalid settings are issued:
TLP_WARN_LEVEL=3

# Operation mode when no power supply can be detected: AC, BAT.
# Concerns some desktop and embedded hardware only.
# Default: <none>
TLP_DEFAULT_MODE=AC

# Operation mode select: 0=depend on power source, 1=always use TLP_DEFAULT_MODE
TLP_PERSISTENT_DEFAULT=0

# Seconds laptop mode has to wait after the disk goes idle before doing a sync.
DISK_IDLE_SECS_ON_AC=0
DISK_IDLE_SECS_ON_BAT=2

# Dirty page values (timeouts in secs).
MAX_LOST_WORK_SECS_ON_AC=15
MAX_LOST_WORK_SECS_ON_BAT=60

# Select a CPU scaling driver operation mode.
CPU_DRIVER_OPMODE_ON_AC=active
CPU_DRIVER_OPMODE_ON_BAT=active

# Select a CPU frequency scaling governor.
CPU_SCALING_GOVERNOR_ON_AC=performance
CPU_SCALING_GOVERNOR_ON_BAT=powersave

# Set CPU energy/performance policies EPP and EPB.
CPU_ENERGY_PERF_POLICY_ON_AC=performance
CPU_ENERGY_PERF_POLICY_ON_BAT=power

# Set Intel CPU P-state performance: 0..100 (%).
CPU_MIN_PERF_ON_AC=0
CPU_MAX_PERF_ON_AC=100
CPU_MIN_PERF_ON_BAT=0
CPU_MAX_PERF_ON_BAT=30

# Set the CPU "turbo boost" (Intel) or "turbo core" (AMD) feature.
CPU_BOOST_ON_AC=1
CPU_BOOST_ON_BAT=0

# Set Intel/AMD CPU dynamic boost feature.
CPU_HWP_DYN_BOOST_ON_AC=1
CPU_HWP_DYN_BOOST_ON_BAT=0

# Kernel NMI Watchdog.
NMI_WATCHDOG=0

# Select platform profile.
PLATFORM_PROFILE_ON_AC=performance
PLATFORM_PROFILE_ON_BAT=low-power

# System suspend mode.
MEM_SLEEP_ON_AC=s2idle
MEM_SLEEP_ON_BAT=deep

# Define disk devices on which the following DISK/AHCI_RUNTIME parameters act.
DISK_DEVICES="nvme0n1 sda"

# Disk advanced power management level.
DISK_APM_LEVEL_ON_AC="254 254"
DISK_APM_LEVEL_ON_BAT="128 128"

# Hard disk spin down timeout.
DISK_SPINDOWN_TIMEOUT_ON_AC="0 0"
DISK_SPINDOWN_TIMEOUT_ON_BAT="20 20"

# Select I/O scheduler for the disk devices.
DISK_IOSCHED="mq-deadline mq-deadline"

# AHCI link power management (ALPM) for SATA disks.
SATA_LINKPWR_ON_AC="max_performance"
SATA_LINKPWR_ON_BAT="med_power_with_dipm"

# Runtime Power Management for NVMe, SATA, ATA and USB disks as well as SATA ports.
AHCI_RUNTIME_PM_ON_AC=on
AHCI_RUNTIME_PM_ON_BAT=auto

# Seconds of inactivity before disk is suspended.
AHCI_RUNTIME_PM_TIMEOUT=15

# Power off optical drive in UltraBay/MediaBay.
BAY_POWEROFF_ON_AC=0
BAY_POWEROFF_ON_BAT=1

# Optical drive device to power off.
BAY_DEVICE="sr0"

# Set the min/max/turbo frequency for the Intel GPU.
INTEL_GPU_MIN_FREQ_ON_AC=100
INTEL_GPU_MIN_FREQ_ON_BAT=100
INTEL_GPU_MAX_FREQ_ON_AC=1250
INTEL_GPU_MAX_FREQ_ON_BAT=1250
INTEL_GPU_BOOST_FREQ_ON_AC=1250
INTEL_GPU_BOOST_FREQ_ON_BAT=1250

# AMD GPU power management.
RADEON_DPM_PERF_LEVEL_ON_AC=auto
RADEON_DPM_PERF_LEVEL_ON_BAT=auto

# Wi-Fi power saving mode.
WIFI_PWR_ON_AC=off
WIFI_PWR_ON_BAT=on

# Disable Wake-on-LAN.
WOL_DISABLE=Y

# Enable audio power saving for Intel HDA, AC97 devices (timeout in secs).
SOUND_POWER_SAVE_ON_AC=0
SOUND_POWER_SAVE_ON_BAT=1

# Disable controller too (HDA only).
SOUND_POWER_SAVE_CONTROLLER=Y

# PCIe Active State Power Management (ASPM).
PCIE_ASPM_ON_AC=performance
PCIE_ASPM_ON_BAT=powersave

# Runtime Power Management for PCIe bus devices.
RUNTIME_PM_ON_AC=on
RUNTIME_PM_ON_BAT=auto

# Exclude listed PCIe device addresses from Runtime PM.
RUNTIME_PM_DENYLIST=""

# Exclude PCIe devices assigned to the listed drivers from Runtime PM.
RUNTIME_PM_DRIVER_DENYLIST="mei_me nouveau radeon"

# Permanently enable/disable Runtime PM for listed PCIe device addresses.
RUNTIME_PM_ENABLE=""
RUNTIME_PM_DISABLE=""

# Set to 0 to disable, 1 to enable USB autosuspend feature.
USB_AUTOSUSPEND=1

# Exclude listed devices from USB autosuspend (separate with spaces).
USB_DENYLIST=""

# Exclude audio devices from USB autosuspend.
USB_EXCLUDE_AUDIO=1

# Exclude bluetooth devices from USB autosuspend.
USB_EXCLUDE_BTUSB=0

# Exclude phone devices from USB autosuspend.
USB_EXCLUDE_PHONE=0

# Exclude printers from USB autosuspend.
USB_EXCLUDE_PRINTER=1

# Exclude WWAN devices from USB autosuspend.
USB_EXCLUDE_WWAN=0

# Allow USB autosuspend for listed devices even if already denylisted or excluded above.
USB_ALLOWLIST=""

# Set to 1 to disable autosuspend before shutdown.
USB_AUTOSUSPEND_DISABLE_ON_SHUTDOWN=0

# Restore radio device state (Bluetooth, WiFi, WWAN) from previous shutdown on system startup.
RESTORE_DEVICE_STATE_ON_STARTUP=1

# Radio devices to disable on startup.
DEVICES_TO_DISABLE_ON_STARTUP="bluetooth nfc wwan"

# Radio devices to enable on startup.
DEVICES_TO_ENABLE_ON_STARTUP="wifi"

# Radio devices to disable on shutdown.
DEVICES_TO_DISABLE_ON_SHUTDOWN="bluetooth nfc wifi wwan"

# Radio devices to enable on shutdown.
DEVICES_TO_ENABLE_ON_SHUTDOWN=""

# Radio devices to enable on AC.
DEVICES_TO_ENABLE_ON_AC="bluetooth nfc wifi wwan"

# Radio devices to disable on battery.
DEVICES_TO_DISABLE_ON_BAT="bluetooth nfc wifi wwan"

# Radio devices to disable on battery when not in use (not connected).
DEVICES_TO_DISABLE_ON_BAT_NOT_IN_USE="bluetooth nfc wifi wwan"

# Battery Care -- Charge thresholds.
# BAT0: Primary / Main / Internal battery
START_CHARGE_THRESH_BAT0=75
STOP_CHARGE_THRESH_BAT0=80

# BAT1: Secondary / Ultrabay / Slice / Replaceable battery
START_CHARGE_THRESH_BAT1=75
STOP_CHARGE_THRESH_BAT1=80

# Restore charge thresholds when AC is unplugged.
RESTORE_THRESHOLDS_ON_BAT=1

# Control battery care drivers.
NATACPI_ENABLE=1
TPACPI_ENABLE=1
TPSMAPI_ENABLE=1

# ------------------------------------------------------------------------------
# tlp-rdw - Parameters for the radio device wizard

# Possible devices: bluetooth, wifi, wwan.
# Separate multiple radio devices with spaces.
# Radio devices to disable on connect.
DEVICES_TO_DISABLE_ON_LAN_CONNECT="wifi wwan"
DEVICES_TO_DISABLE_ON_WIFI_CONNECT="wwan"
DEVICES_TO_DISABLE_ON_WWAN_CONNECT="wifi"

# Radio devices to enable on disconnect.
DEVICES_TO_ENABLE_ON_LAN_DISCONNECT="wifi wwan"
DEVICES_TO_ENABLE_ON_WIFI_DISCONNECT=""
DEVICES_TO_ENABLE_ON_WWAN_DISCONNECT=""

# Radio devices to enable/disable when docked.
DEVICES_TO_ENABLE_ON_DOCK=""
DEVICES_TO_DISABLE_ON_DOCK=""

# Radio devices to enable/disable when undocked.
DEVICES_TO_ENABLE_ON_UNDOCK="wifi"
DEVICES_TO_DISABLE_ON_UNDOCK=""
